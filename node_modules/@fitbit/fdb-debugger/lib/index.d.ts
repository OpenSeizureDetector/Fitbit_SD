/// <reference types="node" />
import { EventEmitter } from 'events';
import * as stream from 'stream';
import * as t from 'io-ts';
import { Peer, TypesafeRequestDispatcher } from '@fitbit/jsonrpc-ts';
import { BulkData, FDBTypes } from '@fitbit/fdb-protocol';
export interface RemoteHostOptions {
    userAgentSuffix?: string;
}
export interface ConsoleMessage {
    timestamp?: Date;
    emittedBy: FDBTypes.AppComponent;
    fromHost?: boolean;
    position?: FDBTypes.Position;
    kind: 'log' | 'info' | 'warn' | 'error';
    message: any[];
}
export interface ConsoleTrace {
    timestamp?: Date;
    emittedBy: FDBTypes.AppComponent;
    stack: FDBTypes.Position[];
    kind: 'trace' | 'assert' | 'exception';
    message: any[];
}
export declare class RemoteHost extends EventEmitter {
    static readonly CAPABILITIES: {
        protocol: {
            maxMessageSize: number;
        };
        console: {
            appLogging: boolean;
        };
        io: {
            write: boolean;
        };
    };
    static readonly USER_AGENT: string;
    dispatcher: TypesafeRequestDispatcher;
    rpc: Peer;
    info: FDBTypes.InitializeResult;
    epoch: Date;
    timeout: number;
    protected bulkDataStreams: BulkData;
    private screenshotReceiver;
    private appContentsListReceiver;
    private heapSnapshotReceiver;
    private serializerTransform;
    protected constructor(timeout: number);
    static connect(hostStream: stream.Duplex, { userAgentSuffix, timeout, }?: {
        userAgentSuffix?: string | undefined;
        timeout?: number | undefined;
    }): Promise<RemoteHost>;
    convertTimestamp(relativeTS: number): Date;
    handleMessage: (params: t.TypeOfPartialProps<{
        timestamp: t.NumberType;
        position: t.IntersectionType<[t.InterfaceType<{
            source: t.RefinementType<t.StringType, string, string, unknown>;
            line: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
            column: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
        }, t.TypeOfProps<{
            source: t.RefinementType<t.StringType, string, string, unknown>;
            line: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
            column: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
        }>, t.OutputOfProps<{
            source: t.RefinementType<t.StringType, string, string, unknown>;
            line: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
            column: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
        }>, unknown>, t.PartialType<{
            generated: t.BooleanType;
            name: t.StringType;
        }, t.TypeOfPartialProps<{
            generated: t.BooleanType;
            name: t.StringType;
        }>, t.OutputOfPartialProps<{
            generated: t.BooleanType;
            name: t.StringType;
        }>, unknown>], t.TypeOfProps<{
            source: t.RefinementType<t.StringType, string, string, unknown>;
            line: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
            column: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
        }> & t.TypeOfPartialProps<{
            generated: t.BooleanType;
            name: t.StringType;
        }>, t.OutputOfProps<{
            source: t.RefinementType<t.StringType, string, string, unknown>;
            line: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
            column: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
        }> & t.OutputOfPartialProps<{
            generated: t.BooleanType;
            name: t.StringType;
        }>, unknown>;
        fromHost: t.BooleanType;
    }> & t.TypeOfProps<{
        emittedBy: t.UnionType<(t.IntersectionType<[t.InterfaceType<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }, t.TypeOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }>, t.OutputOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }>, unknown>, t.InterfaceType<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }, t.TypeOfProps<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }>, t.OutputOfProps<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }>, unknown>], t.TypeOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }> & t.TypeOfProps<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }>, t.OutputOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }> & t.OutputOfProps<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }>, unknown> | t.PartialType<{
            hostID: t.StringType;
        }, t.TypeOfPartialProps<{
            hostID: t.StringType;
        }>, t.OutputOfPartialProps<{
            hostID: t.StringType;
        }>, unknown>)[], (t.TypeOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }> & t.TypeOfProps<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }>) | t.TypeOfPartialProps<{
            hostID: t.StringType;
        }>, (t.OutputOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }> & t.OutputOfProps<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }>) | t.OutputOfPartialProps<{
            hostID: t.StringType;
        }>, unknown>;
        kind: t.UnionType<(t.LiteralType<"log"> | t.LiteralType<"info"> | t.LiteralType<"warn"> | t.LiteralType<"error">)[], "error" | "log" | "info" | "warn", "error" | "log" | "info" | "warn", unknown>;
        message: t.ArrayType<t.AnyType, any[], any[], unknown>;
    }>) => void;
    handleTrace: (params: t.TypeOfProps<{
        emittedBy: t.UnionType<(t.IntersectionType<[t.InterfaceType<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }, t.TypeOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }>, t.OutputOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }>, unknown>, t.InterfaceType<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }, t.TypeOfProps<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }>, t.OutputOfProps<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }>, unknown>], t.TypeOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }> & t.TypeOfProps<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }>, t.OutputOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }> & t.OutputOfProps<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }>, unknown> | t.PartialType<{
            hostID: t.StringType;
        }, t.TypeOfPartialProps<{
            hostID: t.StringType;
        }>, t.OutputOfPartialProps<{
            hostID: t.StringType;
        }>, unknown>)[], (t.TypeOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }> & t.TypeOfProps<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }>) | t.TypeOfPartialProps<{
            hostID: t.StringType;
        }>, (t.OutputOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }> & t.OutputOfProps<{
            component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
        }>) | t.OutputOfPartialProps<{
            hostID: t.StringType;
        }>, unknown>;
        stack: t.ArrayType<t.IntersectionType<[t.InterfaceType<{
            source: t.RefinementType<t.StringType, string, string, unknown>;
            line: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
            column: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
        }, t.TypeOfProps<{
            source: t.RefinementType<t.StringType, string, string, unknown>;
            line: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
            column: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
        }>, t.OutputOfProps<{
            source: t.RefinementType<t.StringType, string, string, unknown>;
            line: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
            column: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
        }>, unknown>, t.PartialType<{
            generated: t.BooleanType;
            name: t.StringType;
        }, t.TypeOfPartialProps<{
            generated: t.BooleanType;
            name: t.StringType;
        }>, t.OutputOfPartialProps<{
            generated: t.BooleanType;
            name: t.StringType;
        }>, unknown>], t.TypeOfProps<{
            source: t.RefinementType<t.StringType, string, string, unknown>;
            line: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
            column: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
        }> & t.TypeOfPartialProps<{
            generated: t.BooleanType;
            name: t.StringType;
        }>, t.OutputOfProps<{
            source: t.RefinementType<t.StringType, string, string, unknown>;
            line: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
            column: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
        }> & t.OutputOfPartialProps<{
            generated: t.BooleanType;
            name: t.StringType;
        }>, unknown>, (t.TypeOfProps<{
            source: t.RefinementType<t.StringType, string, string, unknown>;
            line: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
            column: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
        }> & t.TypeOfPartialProps<{
            generated: t.BooleanType;
            name: t.StringType;
        }>)[], (t.OutputOfProps<{
            source: t.RefinementType<t.StringType, string, string, unknown>;
            line: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
            column: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
        }> & t.OutputOfPartialProps<{
            generated: t.BooleanType;
            name: t.StringType;
        }>)[], unknown>;
        kind: t.UnionType<(t.LiteralType<"trace"> | t.LiteralType<"assert"> | t.LiteralType<"exception">)[], "trace" | "assert" | "exception", "trace" | "assert" | "exception", unknown>;
        message: t.ArrayType<t.AnyType, any[], any[], unknown>;
    }> & t.TypeOfPartialProps<{
        timestamp: t.NumberType;
    }>) => void;
    handleAppRunning: (params: t.TypeOfProps<{
        uuid: t.RefinementType<t.StringType, string, string, unknown>;
        buildID: t.RefinementType<t.StringType, string, string, unknown>;
    }>) => void;
    handleAppClosed: (params: t.TypeOfProps<{
        uuid: t.RefinementType<t.StringType, string, string, unknown>;
        buildID: t.RefinementType<t.StringType, string, string, unknown>;
    }>) => void;
    hasCapability(path: string): boolean;
    readonly maxMessageSize: number;
    protected bindMethod<P extends t.Any, R extends t.Any>(method: string, paramsType: P, resultType: R, { timeoutEnabled, minTimeout, }?: {
        timeoutEnabled?: boolean | undefined;
        minTimeout?: number | undefined;
    }): (params: t.TypeOf<P>) => Promise<t.TypeOf<R>>;
    private initialize;
    ping: () => Promise<void>;
    protected ioWrite: (params: t.TypeOfProps<{
        stream: t.UnionType<(t.StringType | t.RefinementType<t.NumberType, number, number, unknown>)[], string | number, string | number, unknown>;
        data: t.UnionType<(t.StringType | FDBTypes.NodeBufferType)[], string | Buffer, string | Buffer, unknown>;
    }> & t.TypeOfPartialProps<{
        encoding: t.UnionType<(t.LiteralType<"base64"> | t.LiteralType<"none">)[], "none" | "base64", "none" | "base64", unknown>;
    }>) => Promise<any>;
    protected beginStreamingInstall: (params: t.TypeOfProps<{
        componentBundle: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion">)[], "app" | "companion", "app" | "companion", unknown>;
    }>) => Promise<t.TypeOfProps<{
        stream: t.UnionType<(t.StringType | t.RefinementType<t.NumberType, number, number, unknown>)[], string | number, string | number, unknown>;
    }>>;
    protected finalizeStreamingInstall: (params: t.TypeOfProps<{
        stream: t.UnionType<(t.StringType | t.RefinementType<t.NumberType, number, number, unknown>)[], string | number, string | number, unknown>;
    }>) => Promise<t.TypeOfProps<{
        app: t.InterfaceType<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }, t.TypeOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }>, t.OutputOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }>, unknown>;
        components: t.ArrayType<t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>, ("app" | "companion" | "settings")[], ("app" | "companion" | "settings")[], unknown>;
    }> & t.TypeOfPartialProps<{
        installType: t.KeyofType<{
            full: null;
            partial: null;
        }>;
    }>>;
    protected abortStreamingInstall: (params: t.TypeOfProps<{
        stream: t.UnionType<(t.StringType | t.RefinementType<t.NumberType, number, number, unknown>)[], string | number, string | number, unknown>;
    }>) => Promise<any>;
    launchAppComponent: (params: t.TypeOfProps<{
        uuid: t.RefinementType<t.StringType, string, string, unknown>;
        component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
    }> & t.TypeOfPartialProps<{
        debugInstrumentation: t.BooleanType;
    }>) => Promise<t.TypeOfProps<{
        uuid: t.RefinementType<t.StringType, string, string, unknown>;
        buildID: t.RefinementType<t.StringType, string, string, unknown>;
    }> & t.TypeOfProps<{
        component: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion"> | t.LiteralType<"settings">)[], "app" | "companion" | "settings", "app" | "companion" | "settings", unknown>;
    }>>;
    private changeSerialization;
    protected writeToStream(stream: FDBTypes.StreamToken, data: Buffer, { onProgress, }?: {
        onProgress?: ((bytesWritten: number, totalBytes: number) => void) | undefined;
    }): Promise<void>;
    installApp(componentBundle: 'app' | 'companion', data: Buffer, { onProgress, }?: {
        onProgress?: ((bytesWritten: number, totalBytes: number) => void) | undefined;
    }): Promise<{
        app: t.TypeOfProps<{
            uuid: t.RefinementType<t.StringType, string, string, unknown>;
            buildID: t.RefinementType<t.StringType, string, string, unknown>;
        }>;
        components: ("app" | "companion" | "settings")[];
        installType: "full" | "partial";
    } | null>;
    protected beginStreamingScreenshotCapture: (params: t.TypeOfProps<{
        stream: t.UnionType<(t.StringType | t.RefinementType<t.NumberType, number, number, unknown>)[], string | number, string | number, unknown>;
        imageFormat: t.StringType;
    }>) => Promise<t.TypeOfPartialProps<{
        length: t.RefinementType<t.RefinementType<t.NumberType, number, number, unknown>, number, number, unknown>;
    }>>;
    canTakeScreenshot(): boolean;
    screenshotFormats(): string[];
    takeScreenshot(format: string, onWrite?: (received: number, total?: number) => void): Promise<Buffer>;
    private sendEvalCmd;
    hasEvalSupport(): boolean;
    eval(cmd: string): Promise<t.TypeOfProps<{
        success: t.LiteralType<true>;
        value: t.StringType;
    }> | t.TypeOfProps<{
        success: t.LiteralType<false>;
    }>>;
    supportsPartialAppInstall(): boolean;
    protected beginStreamingAppComponentContents: (params: t.TypeOfProps<{
        uuid: t.RefinementType<t.StringType, string, string, unknown>;
        componentBundle: t.UnionType<(t.LiteralType<"app"> | t.LiteralType<"companion">)[], "app" | "companion", "app" | "companion", unknown>;
        stream: t.UnionType<(t.StringType | t.RefinementType<t.NumberType, number, number, unknown>)[], string | number, string | number, unknown>;
    }>) => Promise<any>;
    getInstalledAppContents(uuid: string, componentBundle: FDBTypes.ComponentBundleKind): Promise<t.TypeOfProps<{
        files: t.DictionaryType<t.StringType, t.InterfaceType<{
            sha256: t.StringType;
        }, t.TypeOfProps<{
            sha256: t.StringType;
        }>, t.OutputOfProps<{
            sha256: t.StringType;
        }>, unknown>, t.TypeOfDictionary<t.StringType, t.InterfaceType<{
            sha256: t.StringType;
        }, t.TypeOfProps<{
            sha256: t.StringType;
        }>, t.OutputOfProps<{
            sha256: t.StringType;
        }>, unknown>>, t.OutputOfDictionary<t.StringType, t.InterfaceType<{
            sha256: t.StringType;
        }, t.TypeOfProps<{
            sha256: t.StringType;
        }>, t.OutputOfProps<{
            sha256: t.StringType;
        }>, unknown>>, unknown>;
    }>>;
    getHeapSnapshotSupport(): {
        supported: boolean;
        requiresInstrumentedLaunch: boolean;
        formats: string[];
    };
    protected beginHeapSnapshotCapture: (params: t.TypeOfProps<{
        format: t.StringType;
        stream: t.UnionType<(t.StringType | t.RefinementType<t.NumberType, number, number, unknown>)[], string | number, string | number, unknown>;
    }>) => Promise<any>;
    captureHeapSnapshot(format: string): Promise<Buffer>;
}
//# sourceMappingURL=index.d.ts.map